import{c as E,_ as N,b as G,r as x,u as K,a as X,j as n,y as R,x as ue,a5 as ge,al as me,am as fe,an as be,ao as he}from"./index-3566f683.js";import{P as ye}from"./PageContainer-8f64643d.js";import{B as xe}from"./Breadcrumb-114095a6.js";import{C as P}from"./ChildCard-5d1c9e18.js";import{u as ve,G as Se}from"./Grid-280b352d.js";import{B as Z}from"./Box-dab747f7.js";import{a as ee,g as te,s as oe,B as Ce,c as H,b as re,T as Y}from"./Typography-c66aaf03.js";import{k as Te,Q}from"./ReactToastify-18eadf10.js";import{F as $e,b as ke,S as Be}from"./Select-dd78e7c6.js";import{M as Re}from"./MenuItem-b6fcc323.js";import{b as De}from"./Button-b2b7b55d.js";import{S as je}from"./Stack-e942958e.js";import{u as Me}from"./useDispatch-be3d4271.js";import"./index.esm-7b5037c9.js";import"./Box-cd0d0724.js";import"./Card-59633af4.js";import"./Paper-785f41b1.js";import"./CardHeader-95910895.js";import"./Divider-9e4addf0.js";import"./CardContent-1f868a4d.js";import"./clsx.m-1229b3e0.js";import"./Modal-03ed648e.js";import"./useControlled-3e7e98f7.js";import"./createStack-b3727922.js";import"./styled-dd8fd5cf.js";function Ne(e){return te("MuiToggleButton",e)}const _e=ee("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),q=_e,we=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],Oe=e=>{const{classes:o,fullWidth:r,selected:a,disabled:d,size:f,color:v}=e,b={root:["root",a&&"selected",d&&"disabled",r&&"fullWidth",`size${E(f)}`,v]};return re(b,Ne,o)},ze=oe(Ce,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,o[`size${E(r.size)}`]]}})(({theme:e,ownerState:o})=>{let r=o.color==="standard"?e.palette.text.primary:e.palette[o.color].main,a;return e.vars&&(r=o.color==="standard"?e.vars.palette.text.primary:e.vars.palette[o.color].main,a=o.color==="standard"?e.vars.palette.text.primaryChannel:e.vars.palette[o.color].mainChannel),N({},e.typography.button,{borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active},o.fullWidth&&{width:"100%"},{[`&.${q.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:G(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${q.selected}`]:{color:r,backgroundColor:e.vars?`rgba(${a} / ${e.vars.palette.action.selectedOpacity})`:G(r,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${a} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:G(r,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${a} / ${e.vars.palette.action.selectedOpacity})`:G(r,e.palette.action.selectedOpacity)}}}},o.size==="small"&&{padding:7,fontSize:e.typography.pxToRem(13)},o.size==="large"&&{padding:15,fontSize:e.typography.pxToRem(15)})}),We=x.forwardRef(function(o,r){const a=K({props:o,name:"MuiToggleButton"}),{children:d,className:f,color:v="standard",disabled:b=!1,disableFocusRipple:y=!1,fullWidth:i=!1,onChange:s,onClick:p,selected:T,size:g="medium",value:D}=a,_=X(a,we),$=N({},a,{color:v,disabled:b,disableFocusRipple:y,fullWidth:i,size:g}),j=Oe($),w=l=>{p&&(p(l,D),l.defaultPrevented)||s&&s(l,D)};return n.jsx(ze,N({className:H(j.root,f),disabled:b,focusRipple:!y,ref:r,onClick:w,onChange:s,value:D,ownerState:$,"aria-pressed":T},_,{children:d}))}),Ie=We;function Fe(e,o){return o===void 0||e===void 0?!1:Array.isArray(o)?o.indexOf(e)>=0:e===o}function Le(e){return te("MuiToggleButtonGroup",e)}const Ge=ee("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),C=Ge,Pe=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Ee=e=>{const{classes:o,orientation:r,fullWidth:a,disabled:d}=e,f={root:["root",r==="vertical"&&"vertical",a&&"fullWidth"],grouped:["grouped",`grouped${E(r)}`,d&&"disabled"]};return re(f,Le,o)},Ue=oe("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[{[`& .${C.grouped}`]:o.grouped},{[`& .${C.grouped}`]:o[`grouped${E(r.orientation)}`]},o.root,r.orientation==="vertical"&&o.vertical,r.fullWidth&&o.fullWidth]}})(({ownerState:e,theme:o})=>N({display:"inline-flex",borderRadius:(o.vars||o).shape.borderRadius},e.orientation==="vertical"&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},{[`& .${C.grouped}`]:N({},e.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderTop:0,marginTop:0}})})),Ae=x.forwardRef(function(o,r){const a=K({props:o,name:"MuiToggleButtonGroup"}),{children:d,className:f,color:v="standard",disabled:b=!1,exclusive:y=!1,fullWidth:i=!1,onChange:s,orientation:p="horizontal",size:T="medium",value:g}=a,D=X(a,Pe),_=N({},a,{disabled:b,fullWidth:i,orientation:p,size:T}),$=Ee(_),j=(l,M)=>{if(!s)return;const O=g&&g.indexOf(M);let z;g&&O>=0?(z=g.slice(),z.splice(O,1)):z=g?g.concat(M):[M],s(l,z)},w=(l,M)=>{s&&s(l,g===M?null:M)};return n.jsx(Ue,N({role:"group",className:H($.root,f),ref:r,ownerState:_},D,{children:x.Children.map(d,l=>x.isValidElement(l)?x.cloneElement(l,{className:H($.grouped,l.props.className),onChange:y?w:j,selected:l.props.selected===void 0?Fe(l.props.value,g):l.props.selected,size:l.props.size||T,fullWidth:i,color:l.props.color||v,disabled:l.props.disabled||b}):null)}))}),He=Ae;function Je({slotsData:e,selectedSlots:o,setSelectedSlots:r,intervals:a}){const d=ve(),f=i=>{const[s,p]=i.split(":").map(Number);return s*60+p},v=i=>i.sort((s,p)=>{const T=f(s.split(" - ")[0]),g=f(p.split(" - ")[0]);return T-g}),b=i=>{let s=[];return e==null||e.forEach(p=>{s=s.concat(p.booking_timings.split(","))}),s==null?void 0:s.some(p=>p===i)},y=(i,s)=>{const p=v(s);console.log(p),r(p)};return n.jsx(Z,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",md:"repeat(8, 1fr)",ls:"repeat(9, 1fr)"},gap:"16px"},children:(a==null?void 0:a.length)!==0&&a.map((i,s)=>n.jsx(He,{value:o,onChange:y,"aria-label":"text formatting",children:n.jsxs(Ie,{value:i,disabled:b(i),variant:"contained",sx:{width:"100%",border:(d.palette.mode==="dark","1px solid grey"),color:d.palette.mode==="dark"?"white":"black","&.Mui-selected":{backgroundColor:d.palette.mode==="dark"?"#154c79":"#5462D6",color:"white",boxShadow:d.palette.mode==="dark"?"2px 2px 2px black":"2px 2px 2px grey"},"&.Mui-disabled":{backgroundColor:"rgba(0, 0, 0, 0.12)",color:(d.palette.mode==="dark","grey")}},children:[i.split("-")[0]," - ",i.split("-")[1]]},s)},i+s))})}function Ve(){return n.jsx(P,{sx:{width:"50%"},children:"CalenderView"})}function xt(){const[e,o]=x.useState(`${new Date().getFullYear()}-${String(new Date().getMonth()+1).padStart(2,"0")}-${String(new Date().getDate()).padStart(2,"0")}`),[r,a]=x.useState([]),[d,f]=x.useState([]),[v,b]=x.useState(""),y=R(t=>t.bookingsSliceReducer.roomName),i=R(t=>t.bookingsSliceReducer.roomCategory),s=R(t=>t.bookingsSliceReducer.bookingLocation),p=R(t=>t.novelprofileReducer.account_type),T=R(t=>t.novelprofileReducer.companyName),g=R(t=>t.novelprofileReducer.location),D=R(t=>t.novelprofileReducer.leadsID),_=ue(),$=Me();let j=30,w=7;const l=[{to:"/dashboard",title:"Home"},{to:"/location",title:"Location"},{to:"/category",title:"Category"},{to:"/bookings",title:y},{to:"/bookingslot",title:"Booking Slots"}],O=R(t=>t.bookingsSliceReducer.price)/2*r.length,z=O*(18/100),ae=O+z;x.useEffect(()=>{const t=[],c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let S=0;S<w;S++){const u=new Date;u.setDate(u.getDate()+S);const B=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}`,m=`${String(u.getDate()).padStart(2,"0")}-${k[u.getMonth()]}`,h=c[u.getDay()];t.push({date:B,day:h,formattedDate:m})}f(t),b(t[0].day)},[w]);const se=t=>Q.warn(t,{toastId:"warn"}),ne=t=>Q.error(t,{toastId:"error"});let U="",I="",J=[];const{data:A}=ge("Room Booking Settings","Room Booking Settings"),{data:V,isLoading:ie}=me("/novelite.api.api.getAllData");let F;if(V&&(F=Object.values(V.message.reduce((t,{name:c,room:k,from_time:S,to_time:u,booking_date:B})=>(t[c]?t[c].booking_timings+=`,${S} - ${u}`:t[c]={name:c,room:k,booking_timings:`${S} - ${u}`,booking_date:B},t),{})),F=F.filter(t=>t.room===y&&t.booking_date===e)),d.length!==0){let t=A==null?void 0:A.availability_of_slots.find(c=>c.day_of_week==v);U=t==null?void 0:t.from_time,I=t==null?void 0:t.to_time,I==="23:59:59"&&(I="24:00:00")}if(U!==void 0&&I!==void 0){const t=m=>{var L;const[h,W]=(L=m==null?void 0:m.split(":"))==null?void 0:L.map(Number);return h*60+W},c=m=>{const h=Math.floor(m/60)%24,W=m%60;return`${String(h).padStart(2,"0")}:${String(W).padStart(2,"0")}`},k=t(U),u=t(I)-k,B=Math.floor(u/j);for(let m=0;m<B;m++){const h=k+m*j,W=h+j,L=W>=1440?0:W;J.push(`${c(h)} - ${c(L)}`)}}const le=t=>{a([]),b(t.day),o(t.date)},{call:de}=fe("/novelite.api.api.addDataToDoc"),ce=()=>{let t=`${r}`,c=`${D}-${g}`,[k,S,u]=e.split("-"),B=`${k}-${S}-${u}`,m={location:s,room:y,price:ae,room_type:i,customer:T,client_type:p,booking_date:B,customer_lead_id:c,booking_timings:t,booking_status:"Blocked Temporarily"};r.length!==0?de(m).then(()=>{$(be(r)),$(he(B)),a([]),_("/payment_summary")}).catch(h=>{ne(h.message),console.log("inside catch "+JSON.stringify(h.message))}):se("Please Select any slot to continue")};function pe(t){if(Number.isInteger(t)){let c=t.toString();return c.length>3?c.slice(0,-3)+","+c.slice(-3):c}else return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}return n.jsxs(ye,{title:"Book Slots - Novel Office",children:[n.jsx(xe,{title:"Booking Slots",items:l}),n.jsxs($e,{sx:{minWidth:130,mb:2,mr:4},children:[n.jsx(ke,{id:"demo-simple-select-label",children:"Select Date"}),n.jsx(Be,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:e,label:"Select Date",children:d==null?void 0:d.map(t=>n.jsx(Re,{value:t.date,onClick:()=>le(t),children:t.formattedDate},t.date))})]}),!ie&&n.jsxs(Z,{sx:{display:"flex",flexDirection:{xs:"column",md:"row",ls:"row"},gap:2,width:"100%",p:2},children:[n.jsx(Ve,{}),n.jsx(P,{sx:{width:"50%"},children:n.jsx(Je,{slotsData:F,intervals:J,selectedSlots:r,setSelectedSlots:a})})]}),n.jsxs(Se,{item:!0,xs:12,lg:6,display:"flex",alignItems:"stretch",mt:2,gap:2,children:[n.jsx(P,{title:"",children:n.jsx(De,{variant:"contained",color:"primary",onClick:ce,children:"Proceed"})}),n.jsx(P,{title:"",children:n.jsxs(je,{children:[n.jsxs(Y,{variant:"h4",mb:.5,children:["Price : ₹ ",pe(O)]}),n.jsx(Y,{variant:"h6",color:"primary",children:"(* GST not included)"})]})})]}),n.jsx(Te,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}export{xt as default};
