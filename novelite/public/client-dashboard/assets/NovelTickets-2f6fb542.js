var Qe=Object.defineProperty,Ue=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var Pe=(n,i,o)=>i in n?Qe(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,L=(n,i)=>{for(var o in i||(i={}))Oe.call(i,o)&&Pe(n,o,i[o]);if(ne)for(var o of ne(i))Se.call(i,o)&&Pe(n,o,i[o]);return n},W=(n,i)=>Ue(n,Ke(i));var Re=(n,i)=>{var o={};for(var l in n)Oe.call(n,l)&&i.indexOf(l)<0&&(o[l]=n[l]);if(n!=null&&ne)for(var l of ne(n))i.indexOf(l)<0&&Se.call(n,l)&&(o[l]=n[l]);return o};import{r as u,A as Ze,j as e,_ as ge,e as V,ae,af as ee,Z as ue,d as Je,a4 as Xe,ag as Ye,ah as $e,V as et,ai as tt,aj as st,ak as nt,L as je,I as at}from"./index-5a3f6a76.js";import{B as rt}from"./Breadcrumb-fdd77327.js";import{P as it}from"./PageContainer-ec8a92a5.js";import{C as ot}from"./ChildCard-7fb0986e.js";import{B as b}from"./Box-4fe6d763.js";import{u as lt,G as Y}from"./Grid-40636f23.js";import{f as ct,s as be,T as d}from"./Typography-36c6dc69.js";import{u as Ne}from"./useDispatch-794f7d90.js";import{r as de}from"./createSvgIcon-7fadfa12.js";import{D as ve,P as ut,d as _e}from"./Close-128233da.js";import{k as He,Q as te}from"./ReactToastify-b6ac6425.js";import{T as Ve,t as dt}from"./Tooltip-bce4e40f.js";import{B as H}from"./Box-0fb41966.js";import{T as mt,r as ht,g as Ae}from"./Modal-4ae20275.js";import{F as ie,I as oe,S as le}from"./Select-306a1d3d.js";import{M as ce}from"./MenuItem-e66f9b8b.js";import{T as w}from"./TextField-9d494300.js";import{S as U}from"./Stack-84eaf471.js";import{B as K}from"./Button-0fcc9acd.js";import{T as pt,a as ft,b as xt,c as De,d as M,e as gt}from"./TableRow-f242d18b.js";import{C as jt}from"./Chip-fda8fc18.js";import{R as Ee}from"./Rating-71a93d35.js";import{D as Be,a as Fe}from"./DialogContent-6ac242f3.js";import{I as Le}from"./IconButton-7b3a7669.js";import{D as We}from"./DialogActions-a72d04b3.js";import{C as vt}from"./CircularProgress-3440d5f4.js";import"./index-f9ed67d0.js";import"./index.esm-21a277c7.js";import"./useSlotProps-52eb16c2.js";import"./Link-71046a3e.js";import"./Card-f5a04433.js";import"./Paper-73496770.js";import"./CardHeader-64a3d8c5.js";import"./Divider-0b7a029c.js";import"./dividerClasses-1168dda4.js";import"./CardContent-66ebae48.js";import"./useControlled-ede9ea79.js";import"./ownerWindow-46c4bc4a.js";import"./clsx.m-1229b3e0.js";import"./ListContext-24007cb6.js";import"./useFormControl-c4cdf3b7.js";import"./listItemTextClasses-201dc23b.js";import"./createStack-3bc4d5d9.js";import"./styled-071a7d88.js";import"./visuallyHidden-fa9934b5.js";const Ct=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],bt={entering:{transform:"none"},entered:{transform:"none"}},Nt=u.forwardRef(function(i,o){const l=lt(),x={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:g,appear:h=!0,children:j,easing:a,in:m,onEnter:c,onEntered:E,onEntering:B,onExit:P,onExited:q,onExiting:z,style:A,timeout:D=x,TransitionComponent:O=mt}=i,F=Ze(i,Ct),T=u.useRef(null),G=ct(T,j.ref,o),S=p=>v=>{if(p){const f=T.current;v===void 0?p(f):p(f,v)}},C=S(B),Z=S((p,v)=>{ht(p);const f=Ae({style:A,timeout:D,easing:a},{mode:"enter"});p.style.webkitTransition=l.transitions.create("transform",f),p.style.transition=l.transitions.create("transform",f),c&&c(p,v)}),I=S(E),Q=S(z),J=S(p=>{const v=Ae({style:A,timeout:D,easing:a},{mode:"exit"});p.style.webkitTransition=l.transitions.create("transform",v),p.style.transition=l.transitions.create("transform",v),P&&P(p)}),N=S(q),X=p=>{g&&g(T.current,p)};return e.jsx(O,ge({appear:h,in:m,nodeRef:T,onEnter:Z,onEntered:I,onEntering:C,onExit:J,onExited:N,onExiting:Q,addEndListener:X,timeout:D},F,{children:(p,v)=>u.cloneElement(j,ge({style:ge({transform:"scale(0)",visibility:p==="exited"&&!m?"hidden":void 0},bt[p],A,j.props.style),ref:G},v))}))}),Me=Nt,re=be(b)(()=>({padding:"30px",transition:"0.1s ease-in",cursor:"pointer",color:"inherit","&:hover":{transform:"scale(1.03)"}})),yt=({userEmail:n,filterLocation:i})=>{const o=Ne(),l=V(a=>a.ticketReducer.tickets);l&&l.filter(a=>a.status==="On Hold").length,l&&l.filter(a=>a.status==="Open").length,l&&l.filter(a=>a.status==="Closed").length;const x=()=>{const{data:a}=ee("Issue",i==="ALL"?[["raised_by","=",n]]:[["raised_by","=",n],["location","=",i]],!1);return a||0},g=()=>{const{data:a}=ee("Issue",i==="ALL"?[["status","=","Closed"],["raised_by","=",n]]:[["status","=","Closed"],["raised_by","=",n],["location","=",i]],!1);return a||0},h=()=>{const{data:a}=ee("Issue",i==="ALL"?[["status","=","Pending"],["raised_by","=",n]]:[["status","=","Pending"],["raised_by","=",n],["location","=",i]],!1);return a||0},j=()=>{const{data:a}=ee("Issue",i==="ALL"?[["status","=","In-Progress"],["raised_by","=",n]]:[["status","=","In-Progress"],["raised_by","=",n],["location","=",i]],!1);return a||0};return e.jsxs(Y,{container:!0,spacing:3,textAlign:"center",p:1,children:[e.jsx(Y,{item:!0,xs:6,sm:6,lg:3,children:e.jsxs(re,{onClick:j()!==0?()=>o(ae("In-Progress")):void 0,sx:{backgroundColor:"success.light",color:"success.main",cursor:j()!==0?"pointer":"default"},children:[e.jsx(d,{variant:"h3",children:j()}),e.jsx(d,{variant:"h6",children:"In-Progress"})]})}),e.jsx(Y,{item:!0,xs:6,sm:6,lg:3,children:e.jsxs(re,{onClick:h()!==0?()=>o(ae("Pending")):void 0,sx:{backgroundColor:"warning.light",color:"warning.main",cursor:h()!==0?"pointer":"default"},children:[e.jsx(d,{variant:"h3",children:h()}),e.jsx(d,{variant:"h6",children:"Pending"})]})}),e.jsx(Y,{item:!0,xs:6,sm:6,lg:3,children:e.jsxs(re,{onClick:g()!==0?()=>o(ae("Closed")):void 0,sx:{backgroundColor:"error.light",color:"error.main",cursor:g()!==0?"pointer":"default"},children:[e.jsx(d,{variant:"h3",children:g()}),e.jsx(d,{variant:"h6",children:"Closed"})]})}),e.jsx(Y,{item:!0,xs:6,sm:6,lg:3,children:e.jsxs(re,{onClick:x()!==0?()=>o(ae("total_tickets")):void 0,sx:{backgroundColor:"primary.light",color:"primary.main",cursor:x()!==0?"pointer":"default"},children:[e.jsx(d,{variant:"h3",children:x()}),e.jsx(d,{variant:"h6",children:"Total"})]})})]})},Tt=yt;var ye={},It=ue;Object.defineProperty(ye,"__esModule",{value:!0});var Ce=ye.default=void 0,kt=It(de()),wt=e;Ce=ye.default=(0,kt.default)((0,wt.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var Te={},Pt=ue;Object.defineProperty(Te,"__esModule",{value:!0});var qe=Te.default=void 0,Ot=Pt(de()),St=e;qe=Te.default=(0,Ot.default)((0,St.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help");var Ie={},Rt=ue;Object.defineProperty(Ie,"__esModule",{value:!0});var ze=Ie.default=void 0,_t=Rt(de()),At=e;ze=Ie.default=(0,_t.default)((0,At.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile");const Dt="/assets/novelite/client-dashboard/assets/AC Vent Number Identification-21869f60.jpg",Et=be("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),Bt=be(o=>{var l=o,{className:n}=l,i=Re(l,["className"]);return e.jsx(Ve,W(L({},i),{classes:{popper:n}}))})(({theme:n})=>({[`& .${dt.tooltip}`]:{color:"rgba(0, 0, 0, 0.87)",maxWidth:300,padding:"10px"}}));function Ft({confirmedLocations:n,filterLocation:i,setFilterLocation:o,setOpen1:l,mutate:x,submitTicket:g,setShowLoading:h}){const j=Ne(),a=V(s=>s.novelprofileReducer.fullName),m=V(s=>s.novelprofileReducer.userEmail),[c,E]=u.useState(null),[B,P]=u.useState(!1),[q,z]=u.useState(!1),[A,D]=u.useState(!1),[O,F]=u.useState({subject:"",description:"",location:localStorage.getItem("location")||i,issue:"IT and Network",issueType:"Internet not working | Slow Internet",contactName:"",contactNumber:"",alternateEmail:"",customer:a,email:m,file:"",fileName:"",ventNumber:"",creation_via:"Ticket"}),T={"IT and Network":["Internet not working | Slow Internet","LAN Port | LAN Cable | Patch Cord issue","Computer | Sytem","EPAbx Setup","GSM Issue","Server","Other"],Parking:["Request Additional Parking","New Parking Sticker | New Parking User","P.S. Lost","Pay and Park","P.S. Downsize","Other"],"Security and Access":["Access card Damaged","Access card not working","Access card lost","New Access card","Temporary Access Cards","Other"],"Gate Pass":["MAF","Other"],"Documents and Accounts":["Rental Agreement","NOC","Utility Bill","Property Tax","Property Agreement","Other"],"Accounts and Billing":["Incorrect Invoice","Duplicate Charges","GST Inclusion","Unknown Charges","TDS","Credit Note","Other"],"House Keeping":["Cleaning Required","Foul Odour","Food Spill","Dust Bin Clearing","Cardboard Removal","Carpet Cleaning","Other"],"Office Space Modification":["Desk Expansion | Downsize","Chair Issues","Layout Change","Ammenities : Pedestal, Storage Box 4Ft & 6Ft, Frosting, White Board","Beading Issue","Sound Issue","Door Issues","Carpet Issues","Blinds Issue","Other"],"Restroom | Common Area":["Washroom","Cleaning","Tap Leakage","Tissue Paper Replacement","Foul Smell","Wet Floor","Soap Refill","Faucet Leak","Other"],AC:["Too Hot","Too Cold","AC not Working","Facade Area Issues","Other"],Electrical:["Light Not Working","Light Flickering","Dim Light Replacement","Power Socket Issue","Access Controller","Acess Controller repair","Elevator | Lift not working","Extra UPS | RAW Requirement","Emergency Light","Frequent Power Outage","Other"],"Meeting Room | Conference Room Booking":["Book Meeting  Room","Book Conference Room","Other"]},[G,S]=u.useState(["IT and Network","Parking","Security and Access","Gate Pass","Documents and Accounts","Accounts and Billing","House Keeping","Office Space Modification","Restroom | Common Area","AC","Electrical","Meeting Room | Conference Room Booking","Other"]),[C,Z]=u.useState(G[0]),[I,Q]=u.useState(T[C]?T[C][0]:""),[J,N]=u.useState(T[C]||[]),X=u.useRef(!0);u.useEffect(()=>{C!=="Other"&&I!=="Other"&&F(s=>W(L({},s),{subject:`${C} - ${I}`}))},[C,I]),u.useEffect(()=>{X.current?X.current=!1:we()},[g]);const p=s=>{const t=s.target.value;Z(t);const r=T[t]||["Other"];N(r),Q(r[0]),$("issue",t),$("issueType",r[0])},v=s=>{const t=s.target.value;Q(t),$("issueType",t)},f=s=>{const{name:t,value:r}=s.target;$(t,r)},$=(s,t)=>{F(r=>W(L({},r),{[s]:t}))};Je();const se=s=>te.success(s,{toastId:"success"}),me=s=>te.error(s,{toastId:"error"}),R=s=>te.warn(s,{toastId:"warn"}),he=s=>{const{name:t,value:r}=s.target;F(_=>W(L({},_),{[t]:r}))},pe=s=>{if(s){if(s.size>5242880)return!0}else return!1;const t=s.name.split(".").pop().toLowerCase();return!["pdf","png","jpg","mp4"].includes(t)},we=()=>{const s=W(L({},O),{issueType:I});if(z(!1),h(!0),D(!1),s.subject==="")R("Please fill the ticket Subject"),h(!1);else if(s.contactName==="")R("Please fill the contact Name"),z(!0),h(!1);else if(s.contactNumber==="")R("Please fill the contact Number"),D(!0),h(!1);else if(s.contactNumber.length>10)R("Please enter only 10 numbers"),h(!1);else if(s.location==="ALL"||s.location==="")R("Please Select the Location"),h(!1);else if(pe(c))R("File size cannot be more than 5MB and must be in PDF, PNG, JPG, or MP4 format"),h(!1);else{h(!0);const t=W(L({},O),{issueType:I}),r={subject:t.subject,description:t.description,location:t.location,issue_type:t.issue,custom_issue_subtype:t.issueType,contact_name:t.contactName,contact_phone:t.contactNumber,contact_email_alternative:t.alternateEmail,customer:a,vent_number:t.ventNumber,creation_via:"Ticket"};if(c){const _=new FileReader;_.readAsDataURL(c),_.onloadend=function(){const y=_.result;r.file=y,r.fileName=c.name.split(".")[0],fe(r)}}else fe(r)}},fe=s=>{Xe.post("/api/method/novelite.api.api.issue",s).then(t=>{console.log("Response = ",t),se("Ticket created Successfully"),setTimeout(()=>{h(!1),l(!1),x()},1e3)}).catch(t=>{console.log("inside catch "+JSON.stringify(t.message)),h(!1),me(t.message)})},xe=s=>{let t=s.target.value;o(t),F(r=>W(L({},r),{location:t})),j($e(t)),console.log("Location = ",t),s.target.value!=="Property Location"&&localStorage.setItem("location",t)};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"90%"},children:[e.jsx(Ve,{disableFocusListener:!0,disableTouchListener:!0,placement:"top",TransitionComponent:Me,title:"Property for which you want to rise ticket",children:(n==null?void 0:n.length)>=2?e.jsx(H,{children:e.jsxs(ie,{fullWidth:!0,sx:{mt:2},children:[e.jsx(oe,{id:"demo-simple-select-label",children:"Property Location"}),e.jsx(le,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i,label:"Property Location",onChange:xe,children:n==null?void 0:n.map(s=>e.jsx(ce,{value:s.shortName,children:s.fullName},s.shortName))})]})}):e.jsx(d,{variant:"h4",sx:{mt:2},children:"This customer is not linked to any Location"})}),e.jsxs(ie,{fullWidth:!0,sx:{mt:2},children:[e.jsx(oe,{children:"Issue type"}),e.jsx(le,{value:C,label:"Issue type",onChange:p,children:G.map(s=>e.jsx(ce,{value:s,children:s},s))})]}),C!=="Other"&&e.jsxs(ie,{fullWidth:!0,sx:{mt:2},children:[e.jsx(oe,{children:"Issue sub type"}),e.jsx(le,{value:I,label:"Issue sub type",onChange:v,children:J.map(s=>e.jsx(ce,{value:s,children:s},s))})]}),I==="Other"?e.jsx(w,{label:"Ticket Title",variant:"standard",sx:{width:"100%",mt:2,ml:1},name:"subject",value:O.subject,onChange:f}):null,C==="AC"?e.jsxs(U,{sx:{mt:1},justifyContent:"end",alignItems:"center",flexDirection:"row",children:[e.jsx(w,{label:"Vent number",name:"ventNumber",variant:"standard",sx:{width:"100%",mt:2,ml:1},onChange:f}),e.jsx(Bt,{placement:"left",TransitionComponent:Me,sx:{transform:"translate(-14px, 51px)"},PopperProps:{disablePortal:!0},onClose:()=>{P(Ye.stubFalse)},open:B,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,title:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Dt,width:"100%",alt:"img"}),e.jsx(d,{variant:"p",children:"AC vent Number"})]}),children:e.jsx(qe,{onClick:()=>{P(!B)},sx:{mb:"-2rem"}})})]}):null,e.jsx(H,{sx:{mt:2},children:e.jsx(w,{id:"outlined-multiline-static",label:"Ticket Description",multiline:!0,rows:2,style:{width:"100%"},name:"description",value:O.description,onChange:he})}),e.jsxs(H,{mt:2,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:{xs:"column",md:"row",ls:"row"},gap:2},children:[e.jsxs(K,{component:"label",role:void 0,variant:"outlined",tabIndex:-1,startIcon:e.jsx(ze,{}),children:["Attach file",e.jsx(Et,{type:"file",onChange:s=>E(s.target.files[0])})]}),c&&e.jsx(d,{variant:"p",children:c.name})]}),e.jsx(ve,{sx:{ml:"-2.2em",mb:"-1rem"},children:"Contact Details"}),e.jsxs(H,{sx:{display:"flex",flexDirection:{xs:"column",md:"row",ls:"row"},gap:2},children:[e.jsxs(H,{children:[q?e.jsx(w,{error:!0,label:"Contact Name",variant:"standard",required:!0,style:{width:"100%",marginTop:"16px"},name:"contactName",onChange:f}):e.jsx(w,{label:"Contact Name",variant:"standard",required:!0,style:{width:"100%",marginTop:"16px"},name:"contactName",onChange:f}),A?e.jsx(w,{error:!0,label:"Contact Number",variant:"standard",required:!0,style:{width:"100%",marginTop:"16px"},name:"contactNumber",onChange:f}):e.jsx(w,{label:"Contact Number",variant:"standard",required:!0,style:{width:"100%",marginTop:"16px"},name:"contactNumber",onChange:f})]}),e.jsxs(H,{children:[e.jsx(w,{label:"Email",required:!0,variant:"standard",style:{width:"100%",marginTop:"16px"},name:"email",value:O.email,onChange:f}),e.jsx(w,{label:"Alternate Email (Optional)",variant:"standard",style:{width:"100%",marginTop:"16px"},name:"alternateEmail",onChange:f})]})]})]}),e.jsx(He,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}var ke={},Lt=ue;Object.defineProperty(ke,"__esModule",{value:!0});var Ge=ke.default=void 0,Wt=Lt(de()),Mt=e;Ge=ke.default=(0,Wt.default)((0,Mt.jsx)("path",{d:"m12 8.89.94 3.11h2.82l-2.27 1.62.93 3.01L12 14.79l-2.42 1.84.93-3.01L8.24 12h2.82zM12 2l-2.42 8H2l6.17 4.41L5.83 22 12 17.31 18.18 22l-2.35-7.59L22 10h-7.58z"}),"StarBorderPurple500");const $t=({userEmail:n,totalPages:i,confirmedLocations:o,setFilterLocation:l,filterLocation:x})=>{const g=Ne(),[h,j]=u.useState(!1),[a,m]=u.useState(!1);u.useState(!1);const[c,E]=u.useState(0),[B,P]=u.useState(!1),[q,z]=u.useState(!1),[A,D]=u.useState(0),[O,F]=u.useState(0),[T,G]=u.useState(""),[S,C]=u.useState(""),Z=t=>te.success(t,{toastId:"success"}),I=t=>te.error(t,{toastId:"error"}),Q=(t,r)=>{r=r-1,E(r*10)},J=t=>{let r=t.target.value;l(r),g($e(r)),console.log("Location = ",r),t.target.value!=="Property Location"&&localStorage.setItem("location",r)},{data:N,error:X,isValidating:p,mutate:v}=et("Issue",{fields:["subject","creation","status","raised_by","name","description","location","rating"],filters:x==="ALL"?[["raised_by","=",n]]:[["raised_by","=",n],["location","=",x]],limit_start:c,limit:10,orderBy:{field:"creation",order:"desc"}});var f=[];N&&(g(tt(N)),f=N);const $=()=>{j(!0),P(!1)},se=()=>{j(!1)},me=(t,r)=>{m(!0),F(t),D(0),G(r)},R=()=>{m(!1)},he=()=>{P(!B)},{updateDoc:pe,loading:we,isCompleted:fe}=st(),xe=()=>{pe("Issue",O,{rating:A,review_description:S}).then(t=>{Z("Rated Successfully"),console.log(t),setTimeout(()=>{R(),v()},2e3)}).catch(t=>{console.log(t),I(t)})},s=(t,r,_)=>{if(t!=null)switch(r){case"total_tickets":return t.filter(y=>{var k;return(k=y.subject)==null?void 0:k.toLocaleLowerCase().includes(_)});case"Pending":return t.filter(y=>{var k;return y.status==="Pending"&&((k=y.subject)==null?void 0:k.toLocaleLowerCase().includes(_))});case"Closed":return t.filter(y=>{var k;return y.status==="Closed"&&((k=y.subject)==null?void 0:k.toLocaleLowerCase().includes(_))});case"In-Progress":return t.filter(y=>{var k;return y.status==="In-Progress"&&((k=y.subject)==null?void 0:k.toLocaleLowerCase().includes(_))});default:throw new Error(`Unknown filter: ${r}`)}};if(f!=null&&(f=V(t=>s(t.ticketReducer.tickets,t.ticketReducer.currentFilter,t.ticketReducer.ticketSearch))),N)return e.jsxs(b,{mt:4,children:[e.jsx(b,{display:"flex",justifyContent:{xs:"center",md:"end",ls:"end"},alignItems:"center",children:e.jsx(b,{sx:{mb:2},children:(o==null?void 0:o.length)>=2?e.jsxs(ie,{sx:{m:1,minWidth:170},children:[e.jsx(oe,{id:"demo-simple-select-autowidth-label",children:"Property Location"}),e.jsx(le,{labelId:"demo-simple-select-autowidth-label",id:"demo-simple-select-autowidth",value:x,label:"Property Location",onChange:J,children:o==null?void 0:o.map((t,r)=>e.jsx(ce,{value:t.shortName,children:t.fullName},t.shortName+r))})]}):e.jsx(d,{variant:"h4",children:"This customer is not linked to any Location"})})}),N.length===0&&e.jsxs(U,{alignItems:"center",justifyContent:"center",p:4,children:[e.jsx(d,{variant:"h4",pb:2,children:"There are no tickets"}),e.jsxs(K,{variant:"contained",onClick:$,sx:{ml:1},children:["New  ",e.jsx(Ce,{})]})]}),N.length!==0&&e.jsxs(b,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(b,{children:e.jsxs(K,{variant:"contained",onClick:$,sx:{ml:1},children:["New  ",e.jsx(Ce,{})]})}),e.jsx(b,{sx:{ml:"auto",width:{xs:"8rem",md:"12rem",ls:"12rem"}},display:"flex",justifyContent:"space-between",alignItems:"center",children:e.jsx(w,{size:"small",label:"Search",onChange:t=>g(nt(t.target.value))})})]}),N.length!==0&&e.jsx(pt,{children:e.jsxs(ft,{children:[e.jsx(xt,{children:e.jsxs(De,{children:[e.jsx(M,{children:e.jsx(d,{variant:"h6",children:"Ticket ID"})}),e.jsx(M,{children:e.jsx(d,{variant:"h6",children:"Ticket Name"})}),e.jsx(M,{children:e.jsx(d,{variant:"h6",children:"Status"})}),e.jsx(M,{children:e.jsx(d,{variant:"h6",children:"Rating"})})]})}),e.jsx(gt,{children:f&&f.map(t=>e.jsxs(De,{hover:!0,children:[e.jsx(M,{component:je,to:`/ticket_details/${t.name}`,children:e.jsx(b,{children:e.jsx(d,{variant:"h6",fontWeight:"500",wrap:!0,children:t.name})})}),e.jsx(M,{component:je,to:`/ticket_details/${t.name}`,children:e.jsx(b,{children:e.jsx(d,{variant:"h6",fontWeight:"500",wrap:!0,children:t.subject})})}),e.jsx(M,{component:je,to:`/ticket_details/${t.name}`,children:e.jsx(jt,{sx:{backgroundColor:t.status==="In-Progress"?r=>r.palette.success.light:t.status==="Closed"?r=>r.palette.error.light:t.status==="Pending"?r=>r.palette.warning.light:t.status==="Pending"},size:"small",label:t.status})}),e.jsx(M,{children:t.rating>0?e.jsx(Ee,{name:"read-only",value:t.rating,readOnly:!0}):e.jsx(K,{variant:"outlined",disabled:t.status!=="Closed",onClick:()=>{me(t.name,t.subject)},children:e.jsxs(U,{flexDirection:"row",alignItems:"center",gap:.5,children:["Rate  ",e.jsx(Ge,{})]})})})]},t.subject))})]})}),N.length!==0&&e.jsx(b,{my:3,display:"flex",justifyContent:"center",children:e.jsx(ut,{count:i,color:"primary",onChange:Q})}),e.jsxs(Be,{fullWidth:!0,maxWidth:"sm",open:h,onClose:se,children:[e.jsx(ve,{children:e.jsxs(U,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(d,{variant:"h5",children:"Raise a Ticket"}),e.jsx(Le,{onClick:se,"aria-label":"close",children:e.jsx(_e,{})})]})}),e.jsx(Fe,{children:e.jsx(Ft,{confirmedLocations:o,filterLocation:x,setFilterLocation:l,setOpen1:j,mutate:v,submitTicket:B,setShowLoading:z})}),e.jsx(We,{children:e.jsx(b,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",p:1,children:e.jsx(K,{variant:"contained",onClick:he,disabled:(o==null?void 0:o.length)===1||q,children:q?e.jsx(vt,{color:"inherit",size:26}):"Submit"})})})]}),e.jsxs(Be,{fullWidth:!0,maxWidth:"sm",open:a,onClose:R,children:[e.jsx(ve,{children:e.jsxs(U,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(d,{variant:"h5",children:O}),e.jsx(Le,{onClick:R,"aria-label":"close",children:e.jsx(_e,{})})]})}),e.jsxs(Fe,{children:[e.jsx(He,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsxs(U,{children:[e.jsx(d,{variant:"p",pb:2,children:T}),e.jsx(Ee,{name:"simple-controlled",value:A,onChange:(t,r)=>{D(r)}}),e.jsx(b,{sx:{mt:2},children:e.jsx(w,{id:"outlined-multiline-static",label:"Review Description",multiline:!0,rows:2,style:{width:"100%"},name:"description",value:S,onChange:t=>{C(t.target.value)}})})]})]}),e.jsx(We,{children:e.jsx(b,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",p:1,children:e.jsx(K,{variant:"outlined",onClick:xe,disabled:A===0,children:"Submit"})})})]})]})},Ht=$t,Vt=[{to:"/dashboard",title:"Home"},{title:"Tickets"}];function Bs(){const n=V(m=>m.novelprofileReducer.userEmail),i=V(m=>m.novelprofileReducer.location),o=V(m=>m.novelprofileReducer.companyName),[l,x]=u.useState(i);u.useEffect(()=>{let m=localStorage.getItem("location");m!=="Property Location"&&x(m)},[i,x]);const{data:g}=ee("Issue",l==="ALL"?["raised_by","=",n]:[["raised_by","=",n],["location","=",l]],!1),h=Math.ceil(g/10)||1;var a=(()=>{const{data:m,error:c,isValidating:E,mutate:B}=at("Customer",`${o}`);return m==null?void 0:m.leads.map(P=>P.confirmed_location)})();return a&&(l===null&&(a.length!==0?x(a[0]):x("ALL")),a=a==null?void 0:a.map(c=>{switch(c){case"NTP":return{shortName:c,fullName:"Novel Tech Park - Kudlu Gate"};case"NOM":return{shortName:c,fullName:"Novel Office Marathahalli"};case"NOC":return{shortName:c,fullName:"Novel Office Central - MG Road"};case"NOQ":return{shortName:c,fullName:"Novel Office Queens- Queens Road"};case"NOW":return{shortName:c,fullName:"Novel Office WorkHub- Whitefield"};case"NBP":return{shortName:c,fullName:"Novel Business Park - Adugodi"};case"NOB":return{shortName:c,fullName:"Novel Office Brigade"};case"BTP1F":return{shortName:c,fullName:"Novel Office Brigade-Whitefield"};case"BTP3F":return{shortName:c,fullName:"Novel Office Brigade-Whitefield"};default:return{shortName:c,fullName:c}}}),a==null||a.unshift({shortName:"ALL",fullName:"ALL"}),[{shortName:"NTP",fullName:"Novel Tech Park - Kudlu Gate"},{shortName:"NOM",fullName:"Novel Office Marathahalli"},{shortName:"NOC",fullName:"Novel Office Central - MG Road"},{shortName:"NOQ",fullName:"Novel Office Queens- Queens Road"},{shortName:"NOW",fullName:"Novel Office WorkHub- Whitefield"},{shortName:"NBP",fullName:"Novel Business Park - Adugodi"},{shortName:"NOB",fullName:"Novel Office Brigade"},{shortName:"BTP1F",fullName:"Novel Office Brigade-Whitefield"}].forEach(c=>{a!=null&&a.some(E=>E.shortName===c.shortName)||a==null||a.push(c)})),e.jsxs(it,{title:"Tickets - Novel Office",description:"this is Note page",children:[e.jsx(rt,{title:"Tickets",items:Vt}),e.jsxs(ot,{children:[e.jsx(Tt,{userEmail:n,filterLocation:l}),e.jsx(Ht,{userEmail:n,totalPages:h,confirmedLocations:a,filterLocation:l,setFilterLocation:x})]})]})}export{Bs as default};
