var Ie=Object.defineProperty,Le=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var re=(s,n,a)=>n in s?Ie(s,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[n]=a,w=(s,n)=>{for(var a in n||(n={}))le.call(n,a)&&re(s,a,n[a]);if(q)for(var a of q(n))ce.call(n,a)&&re(s,a,n[a]);return s},P=(s,n)=>Le(s,Se(n));var de=(s,n)=>{var a={};for(var r in s)le.call(s,r)&&n.indexOf(r)<0&&(a[r]=s[r]);if(s!=null&&q)for(var r of q(s))n.indexOf(r)<0&&ce.call(s,r)&&(a[r]=s[r]);return a};import{Z as Ve,j as e,d as te,r as b,A as Ce,P as S,V as Be,L as R,I as Ne,R as he,a9 as Re}from"./index-8b3b8eba.js";import{B as $e}from"./Breadcrumb-180b5288.js";import{P as Oe}from"./PageContainer-d98636eb.js";import{B as c}from"./Box-399c9622.js";import{s as Me,T as m}from"./Typography-1427830e.js";import{k as be,Q as M}from"./ReactToastify-98a908de.js";import{d as me,L as ue,A as pe,D as xe,T as Ee,a as Fe}from"./TimeField-a267871b.js";import{r as We}from"./createSvgIcon-49cf013b.js";import{F as Z,I as J}from"./InputLabel-37dcdfba.js";import{S as X}from"./Select-3a5e17b2.js";import{M as ee}from"./MenuItem-bddb5336.js";import{T as $}from"./TextField-3797edb5.js";import{D as qe}from"./Divider-15ff209d.js";import{D as se,d as Ae}from"./Close-15902f4f.js";import{B as V}from"./Button-8cc464ae.js";import{C as De}from"./CircularProgress-c9018ce5.js";import{T as He,a as Ye,b as ze,c as A,d as g,e as Ge,f as Qe,g as Ke,h as ge,i as ve,j as fe,k as je}from"./LastPage-294bbf53.js";import{S as ie}from"./Stack-d98ae959.js";import{T as Ue}from"./Tooltip-9c6dfe3d.js";import{D as Te,a as ye}from"./DialogContent-1834dda8.js";import{I as O}from"./IconButton-101c88e4.js";import{D as ke}from"./DialogActions-84780869.js";import{u as Ze}from"./useDispatch-878c29d8.js";import"./index.esm-eaeab6e7.js";import"./Grid-f4d7d3ed.js";import"./useSlotProps-70f7ca87.js";import"./Link-52777340.js";import"./useControlled-a5c8634c.js";import"./InputAdornment-2722becb.js";import"./useFormControl-b611f770.js";import"./ownerWindow-fbe9f185.js";import"./isMuiElement-107d3612.js";import"./ListContext-b8157264.js";import"./Modal-06095198.js";import"./Paper-0f05f7b2.js";import"./dividerClasses-27c89fbf.js";import"./listItemTextClasses-4c972a14.js";import"./KeyboardArrowRight-bc2722de.js";import"./Toolbar-44462387.js";import"./createStack-ee48abd7.js";import"./styled-533bb9dc.js";import"./Popper-726b155e.js";Me(c)(()=>({padding:"30px",transition:"0.1s ease-in",cursor:"pointer",color:"inherit","&:hover":{transform:"scale(1.03)"}}));var ae={},Je=Ve;Object.defineProperty(ae,"__esModule",{value:!0});var we=ae.default=void 0,Xe=Je(We()),ei=e;we=ae.default=(0,Xe.default)((0,ei.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block");function ii({billingLocation:s,setOpen1:n,mutate:a}){const r=te(i=>i.novelprofileReducer.fullName),j=te(i=>i.novelprofileReducer.userEmail),[l,u]=b.useState({customer:r,customerEmail:j,visitorName:"",vehicleNumber:"",vehicleType:"",visitorEmail:"",visitLocation:"",billingLead:s.length>0?s[0].leadId:"",billingLoc:s.length>0?s[0].location:"",visitingDate:me(),visitingTime:me()}),[v,p]=b.useState(!1),_=[{location:"Novel Office WorkHub - Whitefield"},{location:"Novel Office Brigade"},{location:"Novel Tech Park - Kudlu Gate"},{location:"Novel Office Brigade - Whitefield"},{location:"Novel Office Central - MG Road"},{location:"Novel Business Park - Adugodi"},{location:"Novel Office Marathahalli"},{location:"Novel Office Queens - Queens Road"}],h=[{type:"Car"},{type:"Bike"}],B=i=>M.success(i,{toastId:"success"}),T=i=>M.error(i,{toastId:"error"}),y=i=>M.warn(i,{toastId:"warn"}),k=i=>{u(o=>P(w({},o),{billingLead:i.leadId,billingLoc:i.location}))},d=i=>{const{name:o,value:x}=i.target;u(C=>P(w({},C),{[o]:x}))},E=i=>{const{value:o}=i.target;u(x=>P(w({},x),{visitLocation:o}))},H=i=>{const o=new Date(i),x=`${o.getDate()}-${o.getMonth()+1}-${o.getFullYear()}`;u(C=>P(w({},C),{visitingDate:x}))},Y=i=>{const o=new Date(i),x=o.getHours(),C=o.getMinutes(),I=x>=12?"PM":"AM",N=`${x%12||12}:${C<10?"0":""}${C} ${I}`;u(L=>P(w({},L),{visitingTime:N}))},z=()=>{p(!0);const{customer:i,customerEmail:o,visitorName:x,vehicleNumber:C,vehicleType:I,visitorEmail:F,visitLocation:N,billingLead:L,billingLoc:W,visitingDate:t,visitingTime:f}=l;if(!(i&&o&&x&&C&&I&&F&&N&&L&&W&&t&&f))y("Please fill in all the details"),p(!1);else{const G=new Date().getTime(),[Q,K,U]=t.split("-");new Date(`${U}-${K}-${Q}`).getTime()<=G?(y("Visiting date must be greater than the current date"),p(!1)):Ce.post("/api/method/novelite.api.api.addDataToleadsAndVisitorParking",l).then(D=>{console.log(D),B("Booking successful"),setTimeout(()=>{p(!1),n(!1),a()},1e3)}).catch(D=>{T(D.message),p(!1),console.log(D)})}};return e.jsxs(c,{children:[e.jsxs(c,{noValidate:!0,component:"form",sx:{display:"flex",flexDirection:"column",m:"auto",width:"90%"},children:[e.jsxs(c,{children:[e.jsxs(Z,{fullWidth:!0,variant:"standard",children:[e.jsx(J,{required:!0,id:"demo-simple-select-helper-label",children:"Billing Location"}),e.jsx(X,{labelId:"demo-simple-select-helper-label",id:"demo-simple-select-helper",value:s.length>0?s[0]:"",label:"Billing Location",onChange:i=>k(i.target.value),disabled:s.length===1,children:s.map((i,o)=>e.jsx(ee,{value:i,children:i.location},o))})]}),e.jsx($,{label:"Your Email",variant:"standard",required:!0,style:{width:"100%",marginTop:"8px"},name:"customerEmail",value:l.customerEmail,onChange:d})]}),e.jsx(qe,{}),e.jsx(se,{sx:{ml:"-2.2em",mb:"-1rem"},children:"Visitor Details"}),e.jsxs(c,{sx:{display:"flex",flexDirection:{xs:"column",md:"row",ls:"row"},gap:2},children:[e.jsxs(c,{children:[e.jsx($,{label:"Visitor Name",variant:"standard",value:l.visitorName,onChange:d,required:!0,style:{width:"100%",marginTop:"16px"},name:"visitorName"}),e.jsx($,{label:"Vehicle Number",variant:"standard",value:l.vehicleNumber,onChange:d,required:!0,style:{width:"100%",marginTop:"16px"},name:"vehicleNumber"})]}),e.jsxs(c,{children:[e.jsx($,{label:"Visitor Email",variant:"standard",value:l.visitorEmail,onChange:d,required:!0,style:{width:"100%",marginTop:"16px"},name:"visitorEmail"}),e.jsxs(Z,{variant:"standard",fullWidth:!0,sx:{mt:2},children:[e.jsx(J,{id:"visit-location-label",children:"Visit Location"}),e.jsx(X,{labelId:"visit-location-label",id:"visit-location-select",value:l.visitLocation,label:"Visit Location",onChange:E,children:_.map(i=>e.jsx(ee,{value:i.location,children:i.location},i.location))})]})]})]}),e.jsxs(Z,{variant:"standard",fullWidth:!0,sx:{mt:2},children:[e.jsx(J,{id:"vehicle-type-label",children:"Vehicle Type"}),e.jsx(X,{labelId:"vehicle-type-label",id:"vehicle-type-select",value:l.vehicleType,label:"Vehicle Type",name:"vehicleType",onChange:d,children:h.map(i=>e.jsx(ee,{value:i.type,children:i.type},i.type))})]}),e.jsxs(c,{sx:{display:"flex",flexDirection:{xs:"column",md:"row",ls:"row"},justifyContent:"space-between",gap:2,mt:2},children:[e.jsx(c,{children:e.jsx(ue,{dateAdapter:pe,children:e.jsx(xe,{components:["TimeField","TimeField","TimeField"],children:e.jsx(Ee,{label:"Time",defaultValue:l.visitingDate,format:"hh:mm a",onChange:i=>{Y(i.$d)}})})})}),e.jsx(c,{children:e.jsx(ue,{dateAdapter:pe,children:e.jsx(xe,{components:["DateField","DateField"],children:e.jsx(Fe,{label:"Date",defaultValue:l.visitingDate,format:"DD-MM-YYYY",onChange:i=>H(i.$d)})})})})]}),e.jsx(V,{variant:"contained",sx:{mt:2},onClick:z,disabled:v,children:v?e.jsx(De,{color:"inherit",size:26}):"Submit"})]}),e.jsx(be,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}S.func.isRequired,S.bool.isRequired,S.string.isRequired;function ti(){Ze();const[s,n]=b.useState(0),[a,r]=b.useState(""),j=te(t=>t.novelprofileReducer.companyName),[l,u]=b.useState(0),[v,p]=b.useState(5),h=(()=>{const{data:t}=Ne("Customer",`${j}`);return t==null?void 0:t.leads.map(f=>({location:f.confirmed_location,leadId:f.leads}))})(),[B,T]=b.useState(!1),y=()=>{T(!0)},k=()=>{T(!1)},[d,E]=b.useState(!1),[H,Y]=b.useState(""),z=t=>{Y(t),E(!0)},i=()=>{E(!1)},{data:o,mutate:x,isLoading:C}=Be("Visitor Parking Pass",{fields:["name","visitor_name","vehicle_type","visit_location","visitor_email","vehicle_no","visit_date","visit_time"],filters:[["customer","=",j]],limit_start:s,orderBy:{field:"creation",order:"desc"}}),I=l>0?Math.max(0,(1+l)*v-(tickets==null?void 0:tickets.length)):0,F=(t,f)=>{u(f)},N=t=>{p(parseInt(t.target.value,10)),u(0)},L=(t,f)=>{const oe=new Date,[G,Q,K]=t.split("-").map(Number),[U,ne]=f.split(" ");let[D,_e]=U.split(":").map(Number);return ne==="PM"&&D!==12&&(D+=12),new Date(G,Q-1,K,D,_e)<oe},W=o==null?void 0:o.filter(t=>{var f;return(f=t.visitor_name)==null?void 0:f.toLowerCase().includes(a==null?void 0:a.toLowerCase())});if(o)return e.jsxs(c,{mt:4,children:[o.length===0&&e.jsxs(ie,{alignItems:"center",justifyContent:"center",p:4,children:[e.jsx(m,{variant:"h4",pb:2,children:"There are no Records to show"}),e.jsx(c,{children:e.jsx(V,{variant:"contained",onClick:y,children:"Book parking pass"})})]}),o.length!==0&&e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{children:e.jsx(V,{variant:"contained",onClick:y,children:"Book parking pass"})}),e.jsx(c,{sx:{maxWidth:"100px",ml:"auto"},children:e.jsx($,{size:"small",label:"Search",fullWidth:!0,value:a,onChange:t=>r(t.target.value)})})]}),o.length!==0&&e.jsx(He,{children:e.jsxs(Ye,{children:[e.jsx(ze,{children:e.jsxs(A,{children:[e.jsx(g,{children:e.jsx(m,{variant:"h6",children:"Visitor Name"})}),e.jsx(g,{children:e.jsx(m,{variant:"h6",children:"Visit Date"})}),e.jsx(g,{children:e.jsx(m,{variant:"h6",children:"Visit Time"})}),e.jsx(g,{children:e.jsx(m,{variant:"h6",children:"Visitor Vehicle No"})}),e.jsx(g,{children:e.jsx(m,{variant:"h6",children:"Visitor Location"})}),e.jsx(g,{align:"center",children:e.jsx(m,{variant:"h6",children:"Action"})})]})}),W&&e.jsxs(Ge,{children:[W.map(t=>e.jsxs(A,{hover:!0,children:[e.jsx(g,{component:R,to:`/visit_details/${t.name}`,children:e.jsx(m,{variant:"h6",children:t.visitor_name})}),e.jsx(g,{component:R,to:`/visit_details/${t.name}`,children:e.jsxs(c,{children:[e.jsx(m,{variant:"h6",fontWeight:"500",noWrap:!0,children:t.visit_date}),e.jsx(m,{color:"textSecondary",noWrap:!0,sx:{maxWidth:"250px"},variant:"subtitle2",fontWeight:"400",children:t.visit_time})]})}),e.jsx(g,{component:R,to:`/visit_details/${t.name}`,children:e.jsx(ie,{direction:"row",gap:"10px",alignItems:"center",children:e.jsx(m,{variant:"h6",children:t.visit_time})})}),e.jsx(g,{component:R,to:`/visit_details/${t.name}`,children:e.jsx(m,{children:t.vehicle_no})}),e.jsx(g,{component:R,to:`/visit_details/${t.name}`,children:e.jsx(m,{children:t.visit_location})}),e.jsx(g,{children:e.jsx(Ue,{title:"Cancel Booking",children:e.jsx(V,{color:"error",onClick:()=>z(t.name),disabled:L(t.visit_date,t.visit_time),children:L(t.visit_date,t.visit_time)?e.jsx(we,{}):"Cancel"})})})]},t.name)),I>0&&e.jsx(A,{style:{height:53*I},children:e.jsx(g,{colSpan:6})})]}),e.jsx(Qe,{children:e.jsx(A,{children:e.jsx(Ke,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:6,count:o==null?void 0:o.length,rowsPerPage:v,page:l,SelectProps:{inputprops:{"aria-label":"rows per page"},native:!0},onPageChange:F,onRowsPerPageChange:N,ActionsComponent:si})})})]})}),e.jsxs(Te,{fullWidth:!0,maxWidth:"sm",open:B,onClose:k,children:[e.jsx(se,{children:e.jsxs(ie,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(m,{variant:"h5",children:"Book a pass"}),e.jsx(O,{onClick:k,"aria-label":"close",children:e.jsx(Ae,{})})]})}),e.jsx(ye,{children:h&&e.jsx(ii,{setOpen1:T,mutate:x,billingLocation:h})}),e.jsx(ke,{})]}),e.jsx(Pe,{id:"ringtone-menu",keepMounted:!0,open:d,mutate:x,onClose:i,visitorId:H})]})}function Pe(s){const k=s,{onClose:n,visitorId:a,open:r,mutate:j}=k,l=de(k,["onClose","visitorId","open","mutate"]),u=he.useRef(null),[v,p]=he.useState(!1),_=d=>M.success(d,{toastId:"success"}),h=d=>M.error(d,{toastId:"error"}),B=()=>{u.current!=null&&u.current.focus()},T=()=>{n()},y=()=>{p(!0),a&&Ce.post("/api/method/novelite.api.api.removeDataFromLeadsAndVisitorParking",{vps_id:a}).then(d=>{console.log(d),_("Booking Cancelled succesfully"),setTimeout(()=>{n(),j(),p(!1)},1e3)}).catch(d=>{h(d.message),p(!1),console.log(d)})};return e.jsxs(Te,P(w({sx:{"& .MuiDialog-paper":{width:"80%",maxHeight:435}},maxWidth:"xs",TransitionProps:{onEntering:B},open:r},l),{children:[e.jsx(se,{children:"Cancel Visitor parking pass?"}),e.jsx(ye,{dividers:!0,children:"Do you want to cancel Visitor parking pass?"}),e.jsxs(ke,{children:[!v&&e.jsx(V,{autoFocus:!0,onClick:T,children:"Cancel"}),e.jsx(V,{onClick:y,disabled:v,children:v?e.jsx(De,{color:"inherit",size:24}):"Ok"})]}),e.jsx(be,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]}))}Pe.propTypes={onClose:S.func.isRequired,open:S.bool.isRequired,visitorId:S.string.isRequired};function si(s){const n=Re(),{count:a,page:r,rowsPerPage:j,onPageChange:l}=s,u=h=>{l(h,0)},v=h=>{l(h,r-1)},p=h=>{l(h,r+1)},_=h=>{l(h,Math.max(0,Math.ceil(a/j)-1))};return e.jsxs(c,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(O,{onClick:u,disabled:r===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(ge,{}):e.jsx(ve,{})}),e.jsx(O,{onClick:v,disabled:r===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(fe,{}):e.jsx(je,{})}),e.jsx(O,{onClick:p,disabled:r>=Math.ceil(a/j)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx(je,{}):e.jsx(fe,{})}),e.jsx(O,{onClick:_,disabled:r>=Math.ceil(a/j)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(ve,{}):e.jsx(ge,{})})]})}const ai=[{to:"/dashboard",title:"Home"},{title:"Visitor parking pass"}];function Ki(){return e.jsxs(Oe,{title:"Visitor parking pass - Novel Office",description:"this is Sales Visitor parking pass page",children:[e.jsx($e,{title:"Visitor parking pass",items:ai}),e.jsx(ti,{})]})}export{Ki as default};
