import{aU as G,a2 as M,ap as L,r as b,ad as U,a3 as A,j as c,e as w,u as K,c2 as X,bZ as tt,bV as et,c6 as ot}from"./index-4c0b60c1.js";import{P as rt}from"./PageContainer-1e378f9f.js";import{B as at}from"./Breadcrumb-993a2ffd.js";import{C as st}from"./ChildCard-1408395c.js";import{u as it,G as nt}from"./Grid-858c8d28.js";import{B as lt}from"./Box-4e6b8719.js";import{a as H,g as V,s as Y,B as dt,d as F,c as J}from"./Typography-d41e00bf.js";import{k as ct,Q as pt}from"./ReactToastify-7b7ec94e.js";import{F as ut}from"./FormControl-05733a9f.js";import{I as gt}from"./InputLabel-60b08834.js";import{S as mt}from"./Select-fa541a15.js";import{M as ft}from"./MenuItem-9cba98ac.js";import{B as bt}from"./Button-7b1b6ba5.js";import{u as yt}from"./useDispatch-cfa82895.js";import"./index.esm-ab86738a.js";import"./Link-600c6b92.js";import"./Box-62c7ea08.js";import"./Card-93702703.js";import"./CardHeader-c9fcc5f5.js";import"./Divider-1c3d9281.js";import"./dividerClasses-4698ac49.js";import"./CardContent-3ef2c0f8.js";import"./clsx.m-1229b3e0.js";import"./utils-5ebfb48b.js";import"./useFormControl-4a8d5a10.js";import"./isMuiElement-06cc0e9d.js";import"./formControlState-02eb4045.js";import"./Popover-78ca825b.js";import"./Modal-e69de70e.js";import"./Fade-11f6ebc6.js";import"./utils-7ef43b08.js";import"./ownerDocument-613eb639.js";import"./ownerWindow-698471fc.js";import"./createChainedFunction-0bab83cf.js";import"./Portal-a2e45162.js";import"./Grow-34c80021.js";import"./List-14aaf110.js";import"./ListContext-73043c56.js";import"./useControlled-aa938a2a.js";import"./useId-ab6b636f.js";import"./InputBase-e88cc6c4.js";import"./listItemIconClasses-9b443d96.js";import"./listItemTextClasses-35935c78.js";function ht(t){return V("MuiToggleButton",t)}const vt=H("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),E=vt,xt=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],Ct=t=>{const{classes:e,fullWidth:r,selected:a,disabled:l,size:u,color:y}=t,g={root:["root",a&&"selected",l&&"disabled",r&&"fullWidth",`size${G(u)}`,y]};return J(g,ht,e)},kt=Y(dt,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`size${G(r.size)}`]]}})(({theme:t,ownerState:e})=>{let r=e.color==="standard"?t.palette.text.primary:t.palette[e.color].main,a;return t.vars&&(r=e.color==="standard"?t.vars.palette.text.primary:t.vars.palette[e.color].main,a=e.color==="standard"?t.vars.palette.text.primaryChannel:t.vars.palette[e.color].mainChannel),M({},t.typography.button,{borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active},e.fullWidth&&{width:"100%"},{[`&.${E.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:L(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${E.selected}`]:{color:r,backgroundColor:t.vars?`rgba(${a} / ${t.vars.palette.action.selectedOpacity})`:L(r,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${a} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:L(r,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${a} / ${t.vars.palette.action.selectedOpacity})`:L(r,t.palette.action.selectedOpacity)}}}},e.size==="small"&&{padding:7,fontSize:t.typography.pxToRem(13)},e.size==="large"&&{padding:15,fontSize:t.typography.pxToRem(15)})}),Bt=b.forwardRef(function(e,r){const a=U({props:e,name:"MuiToggleButton"}),{children:l,className:u,color:y="standard",disabled:g=!1,disableFocusRipple:f=!1,fullWidth:n=!1,onChange:s,onClick:d,selected:k,size:p="medium",value:h}=a,S=A(a,xt),$=M({},a,{color:y,disabled:g,disableFocusRipple:f,fullWidth:n,size:p}),j=Ct($),R=i=>{d&&(d(i,h),i.defaultPrevented)||s&&s(i,h)};return c.jsx(kt,M({className:F(j.root,u),disabled:g,focusRipple:!f,ref:r,onClick:R,onChange:s,value:h,ownerState:$,"aria-pressed":k},S,{children:l}))}),Tt=Bt;function St(t,e){return e===void 0||t===void 0?!1:Array.isArray(e)?e.indexOf(t)>=0:t===e}function $t(t){return V("MuiToggleButtonGroup",t)}const Rt=H("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),C=Rt,Mt=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],_t=t=>{const{classes:e,orientation:r,fullWidth:a,disabled:l}=t,u={root:["root",r==="vertical"&&"vertical",a&&"fullWidth"],grouped:["grouped",`grouped${G(r)}`,l&&"disabled"]};return J(u,$t,e)},zt=Y("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${C.grouped}`]:e.grouped},{[`& .${C.grouped}`]:e[`grouped${G(r.orientation)}`]},e.root,r.orientation==="vertical"&&e.vertical,r.fullWidth&&e.fullWidth]}})(({ownerState:t,theme:e})=>M({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},t.orientation==="vertical"&&{flexDirection:"column"},t.fullWidth&&{width:"100%"},{[`& .${C.grouped}`]:M({},t.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderTop:0,marginTop:0}})})),jt=b.forwardRef(function(e,r){const a=U({props:e,name:"MuiToggleButtonGroup"}),{children:l,className:u,color:y="standard",disabled:g=!1,exclusive:f=!1,fullWidth:n=!1,onChange:s,orientation:d="horizontal",size:k="medium",value:p}=a,h=A(a,Mt),S=M({},a,{disabled:g,fullWidth:n,orientation:d,size:k}),$=_t(S),j=(i,v)=>{if(!s)return;const O=p&&p.indexOf(v);let _;p&&O>=0?(_=p.slice(),_.splice(O,1)):_=p?p.concat(v):[v],s(i,_)},R=(i,v)=>{s&&s(i,p===v?null:v)};return c.jsx(zt,M({role:"group",className:F($.root,u),ref:r,ownerState:S},h,{children:b.Children.map(l,i=>b.isValidElement(i)?b.cloneElement(i,{className:F($.grouped,i.props.className),onChange:f?R:j,selected:i.props.selected===void 0?St(i.props.value,p):i.props.selected,size:i.props.size||k,fullWidth:n,color:i.props.color||y,disabled:i.props.disabled||g}):null)}))}),Ot=jt;function Dt({slotsData:t,selectedSlots:e,setSelectedSlots:r,intervals:a}){const l=it(),u=n=>{const[s,d]=n.split(":").map(Number);return s*60+d},y=n=>n.sort((s,d)=>{const k=u(s.split(" - ")[0]),p=u(d.split(" - ")[0]);return k-p}),g=n=>{let s=[];return t==null||t.forEach(d=>{s=s.concat(d.booking_timings.split(","))}),s==null?void 0:s.some(d=>d===n)},f=(n,s)=>{const d=y(s);console.log(d),r(d)};return c.jsx(lt,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",md:"repeat(8, 1fr)",ls:"repeat(9, 1fr)"},gap:"16px"},children:(a==null?void 0:a.length)!==0&&a.map((n,s)=>c.jsx(Ot,{value:e,onChange:f,"aria-label":"text formatting",children:c.jsxs(Tt,{value:n,disabled:g(n),variant:"contained",sx:{width:"100%",border:(l.palette.mode==="dark","1px solid grey"),color:l.palette.mode==="dark"?"white":"black","&.Mui-selected":{backgroundColor:l.palette.mode==="dark"?"#154c79":"#5462D6",color:"white",boxShadow:l.palette.mode==="dark"?"2px 2px 2px black":"2px 2px 2px grey"},"&.Mui-disabled":{backgroundColor:"rgba(0, 0, 0, 0.12)",color:(l.palette.mode==="dark","grey")}},children:[n.split("-")[0]," - ",n.split("-")[1]]},s)},n+s))})}function Te(){const[t,e]=b.useState(`${String(new Date().getDate()).padStart(2,"0")}-${String(new Date().getMonth()+1).padStart(2,"0")}-${new Date().getFullYear()}`),[r,a]=b.useState([]),[l,u]=b.useState([]),[y,g]=b.useState(""),f=w(o=>o.bookingsSliceReducer.roomName),n=w(o=>o.bookingsSliceReducer.roomCategory),s=w(o=>o.bookingsSliceReducer.bookingLocation),d=w(o=>o.novelprofileReducer.account_type),k=K(),p=yt();let h=30,S=7;b.useEffect(()=>{const o=[],B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(let T=0;T<S;T++){const x=new Date;x.setDate(x.getDate()+T);const D=`${String(x.getDate()).padStart(2,"0")}-${String(x.getMonth()+1).padStart(2,"0")}-${x.getFullYear()}`,W=B[x.getDay()];o.push({date:D,day:W})}u(o),g(o[0].day)},[S]);const $=o=>pt.warn(o,{toastId:"warn"}),j=[{to:"/dashboard",title:"Home"},{to:"/location",title:"Location"},{to:"/category",title:"Category"},{to:"/bookings",title:f},{to:"/bookingslot",title:"Booking Slots"}];let R="",i="",v=[];const{data:O,mutate:_}=X("Room Bookings",{fields:["location","booking_timings","booking_date"],filters:[["booking_date","=",t],["room","=",f]],limit_start:0,limit:2e3}),{data:I}=tt("Room Booking Settings","Room Booking Settings");if(l.length!==0){let o=I==null?void 0:I.availability_of_slots.find(B=>B.day_of_week==y);R=o==null?void 0:o.from_time,i=o==null?void 0:o.to_time,i==="23:59:59"&&(i="24:00:00")}if(R!==void 0&&i!==void 0){const o=m=>{var P;const[z,N]=(P=m==null?void 0:m.split(":"))==null?void 0:P.map(Number);return z*60+N},B=m=>{const z=Math.floor(m/60),N=m%60;return`${String(z).padStart(2,"0")}:${String(N).padStart(2,"0")}`},T=o(R),D=o(i)-T,W=Math.floor(D/h);for(let m=0;m<W;m++){const z=T+m*h,N=z+h;v.push(`${B(z)} - ${B(N)}`)}}const Q=o=>{a([]),e(o.date),g(o.day)},{createDoc:Z,isCompleted:Wt}=et(),q=()=>{let o=`${r}`,[B,T,x]=t.split("-"),D=`${x}-${T}-${B}`,W={booking_status:"Blocked Temporarily",location:s,room:f,room_type:n,booking_timings:o,booking_date:D,client_type:d};r.length!==0?Z("Room Bookings",W).then(()=>{p(ot(r)),a([]),_(),k("/payment_summary")}).catch(m=>{console.log("inside catch "+JSON.stringify(m.message))}):$("Please Select any slot to continue")};return c.jsxs(rt,{title:"Book Slots - Novel Office",children:[c.jsx(at,{title:"Booking Slots",items:j}),c.jsxs(ut,{sx:{minWidth:170,mb:2,mr:4},children:[c.jsx(gt,{id:"demo-simple-select-label",children:"Select Date"}),c.jsx(mt,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t,label:"Select Date",children:l==null?void 0:l.map(o=>c.jsx(ft,{value:o.date,onClick:()=>Q(o),children:o.date},o.date))})]}),O&&c.jsx(Dt,{slotsData:O,selectedSlots:r,setSelectedSlots:a,intervals:v}),c.jsx(nt,{item:!0,xs:12,lg:6,display:"flex",alignItems:"stretch",children:c.jsx(st,{title:"",children:c.jsx(bt,{variant:"contained",color:"primary",onClick:q,children:"Proceed"})})}),c.jsx(ct,{position:"top-center",autoClose:1e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}export{Te as default};
